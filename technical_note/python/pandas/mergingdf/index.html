<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Othmane Rifki">

  
  
  
    
  
  <meta name="description" content="Merging with specific columns import pandas as pd gold = pd.read_csv(&#39;SummerOlympic/Gold.csv&#39;) bronze = pd.read_csv(&#39;SummerOlympic/Bronze.csv&#39;)  gold.head()   .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .">

  
  <link rel="alternate" hreflang="en-us" href="http://othrif.github.io/technical_note/python/pandas/mergingdf/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="http://othrif.github.io/technical_note/python/pandas/mergingdf/">

  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Othmane Rifki">
  <meta property="og:url" content="http://othrif.github.io/technical_note/python/pandas/mergingdf/">
  <meta property="og:title" content="Merging DataFrames with merge() and join() | Othmane Rifki">
  <meta property="og:description" content="Merging with specific columns import pandas as pd gold = pd.read_csv(&#39;SummerOlympic/Gold.csv&#39;) bronze = pd.read_csv(&#39;SummerOlympic/Bronze.csv&#39;)  gold.head()   .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } ."><meta property="og:image" content="img/map[gravatar:%!s(bool=false) shape:circle]">
  <meta property="twitter:image" content="img/map[gravatar:%!s(bool=false) shape:circle]"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2020-04-12T14:41:32&#43;02:00">
    
    <meta property="article:modified_time" content="2020-04-12T14:41:32&#43;02:00">
  

  



  


  


  





  <title>Merging DataFrames with merge() and join() | Othmane Rifki</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Othmane Rifki</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Othmane Rifki</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#talks"><span>Talks</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/technical_note"><span>Technical Notes</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/OthmaneRifki_CV.pdf"><span>CV</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/contact"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link js-theme-selector" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-palette" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


   


<article>
  <div class="technical_note">
  <header>
    <h1 class="technical_note_title">Merging DataFrames with merge() and join()</h1>
    <div class="technical_note_date">
      <time datetime=" 2020-04-12T14:41:32&#43;02:00 ">Apr 12, 2020</time>
    </div>
  </header>
  <div class="content">

  <h3 id="merging-with-specific-columns">Merging with specific columns</h3>
<pre><code class="language-python">import pandas as pd

gold = pd.read_csv('SummerOlympic/Gold.csv')
bronze = pd.read_csv('SummerOlympic/Bronze.csv')
</code></pre>
<pre><code class="language-python">gold.head()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NOC</th>
      <th>Country</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>USA</td>
      <td>United States</td>
      <td>2088.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>URS</td>
      <td>Soviet Union</td>
      <td>838.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>GBR</td>
      <td>United Kingdom</td>
      <td>498.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>FRA</td>
      <td>France</td>
      <td>378.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GER</td>
      <td>Germany</td>
      <td>407.0</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code class="language-python">bronze.head()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NOC</th>
      <th>Country</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>USA</td>
      <td>United States</td>
      <td>1052.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>URS</td>
      <td>Soviet Union</td>
      <td>584.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>GBR</td>
      <td>United Kingdom</td>
      <td>505.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>FRA</td>
      <td>France</td>
      <td>475.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GER</td>
      <td>Germany</td>
      <td>454.0</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code class="language-python">combine = pd.merge(gold, bronze, on=['NOC','Country'], suffixes=['_gold','_bronze'])
print(combine)
</code></pre>
<pre><code>     NOC               Country  Total_gold  Total_bronze
0    USA         United States      2088.0        1052.0
1    URS          Soviet Union       838.0         584.0
2    GBR        United Kingdom       498.0         505.0
3    FRA                France       378.0         475.0
4    GER               Germany       407.0         454.0
..   ...                   ...         ...           ...
133  SEN               Senegal         NaN           NaN
134  SUD                 Sudan         NaN           NaN
135  TGA                 Tonga         NaN           NaN
136  BDI               Burundi         1.0           NaN
137  UAE  United Arab Emirates         1.0           NaN

[138 rows x 4 columns]
</code></pre>
<h3 id="merging-on-columns-with-non-matching-labelsspecifying-columns-to-merge">Merging on columns with non-matching labelsSpecifying columns to merge</h3>
<pre><code class="language-python">revenue = pd.read_csv('Sales/revenue.csv', delim_whitespace=True)
managers = pd.read_csv('Sales/managers.csv', delim_whitespace=True)
</code></pre>
<pre><code class="language-python">revenue
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>city</th>
      <th>branch_id</th>
      <th>state</th>
      <th>revenue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Austin</td>
      <td>10</td>
      <td>TX</td>
      <td>100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Denver</td>
      <td>20</td>
      <td>CO</td>
      <td>83</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Springfield</td>
      <td>30</td>
      <td>IL</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Mendocino</td>
      <td>47</td>
      <td>CA</td>
      <td>200</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code class="language-python">managers
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>branch</th>
      <th>branch_id</th>
      <th>state</th>
      <th>manager</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Austin</td>
      <td>10</td>
      <td>TX</td>
      <td>Charlers</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Denver</td>
      <td>20</td>
      <td>CO</td>
      <td>Joel</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mendocino</td>
      <td>47</td>
      <td>CA</td>
      <td>Brett</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Springfield</td>
      <td>31</td>
      <td>MO</td>
      <td>Sally</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code class="language-python">combine = pd.merge(revenue, managers, left_on='city', right_on='branch')
</code></pre>
<pre><code class="language-python">combine
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>city</th>
      <th>branch_id_x</th>
      <th>state_x</th>
      <th>revenue</th>
      <th>branch</th>
      <th>branch_id_y</th>
      <th>state_y</th>
      <th>manager</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Austin</td>
      <td>10</td>
      <td>TX</td>
      <td>100</td>
      <td>Austin</td>
      <td>10</td>
      <td>TX</td>
      <td>Charlers</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Denver</td>
      <td>20</td>
      <td>CO</td>
      <td>83</td>
      <td>Denver</td>
      <td>20</td>
      <td>CO</td>
      <td>Joel</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Springfield</td>
      <td>30</td>
      <td>IL</td>
      <td>4</td>
      <td>Springfield</td>
      <td>31</td>
      <td>MO</td>
      <td>Sally</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Mendocino</td>
      <td>47</td>
      <td>CA</td>
      <td>200</td>
      <td>Mendocino</td>
      <td>47</td>
      <td>CA</td>
      <td>Brett</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="merging-with-innerouter-join">Merging with inner/outer join</h3>
<p>inner join is the default behavior.</p>
<pre><code class="language-python">gold = gold.sort_values('Total',ascending=False).iloc[:5]
bronze = bronze.sort_values('Total',ascending=False).iloc[:5]
</code></pre>
<pre><code class="language-python">combine = pd.merge(gold, bronze, on=['NOC','Country'], suffixes=['_gold','_bronze'], how='inner')
print(combine.head())
</code></pre>
<pre><code>   NOC         Country  Total_gold  Total_bronze
0  USA   United States      2088.0        1052.0
1  URS    Soviet Union       838.0         584.0
2  GBR  United Kingdom       498.0         505.0
3  GER         Germany       407.0         454.0
</code></pre>
<pre><code class="language-python">combine = pd.merge(gold, bronze, on=['NOC','Country'], suffixes=['_gold','_bronze'], how='outer')
print(combine.head())
</code></pre>
<pre><code>   NOC         Country  Total_gold  Total_bronze
0  USA   United States      2088.0        1052.0
1  URS    Soviet Union       838.0         584.0
2  GBR  United Kingdom       498.0         505.0
3  ITA           Italy       460.0           NaN
4  GER         Germany       407.0         454.0
</code></pre>
<h3 id="merging-with-leftright-join-default">Merging with left/right join (Default)</h3>
<p>Notice that Italy was picked up from <code>gold</code> but since it does not appear in <code>bronze</code>, it gets a Not a Number (NaN) value.</p>
<pre><code class="language-python">combine = pd.merge(gold, bronze, on=['NOC','Country'], suffixes=['_gold','_bronze'], how='left')
print(combine.head())
</code></pre>
<pre><code>   NOC         Country  Total_gold  Total_bronze
0  USA   United States      2088.0        1052.0
1  URS    Soviet Union       838.0         584.0
2  GBR  United Kingdom       498.0         505.0
3  ITA           Italy       460.0           NaN
4  GER         Germany       407.0         454.0
</code></pre>
<pre><code class="language-python">combine = pd.merge(gold, bronze, on=['NOC','Country'], suffixes=['_gold','_bronze'], how='right')
print(combine.head())
</code></pre>
<pre><code>   NOC         Country  Total_gold  Total_bronze
0  USA   United States      2088.0        1052.0
1  URS    Soviet Union       838.0         584.0
2  GBR  United Kingdom       498.0         505.0
3  GER         Germany       407.0         454.0
4  FRA          France         NaN         475.0
</code></pre>
<h3 id="using-join">Using .join()</h3>
<pre><code class="language-python">gold
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NOC</th>
      <th>Country</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>USA</td>
      <td>United States</td>
      <td>2088.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>URS</td>
      <td>Soviet Union</td>
      <td>838.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>GBR</td>
      <td>United Kingdom</td>
      <td>498.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ITA</td>
      <td>Italy</td>
      <td>460.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GER</td>
      <td>Germany</td>
      <td>407.0</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code class="language-python">bronze
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NOC</th>
      <th>Country</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>USA</td>
      <td>United States</td>
      <td>1052.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>URS</td>
      <td>Soviet Union</td>
      <td>584.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>GBR</td>
      <td>United Kingdom</td>
      <td>505.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>FRA</td>
      <td>France</td>
      <td>475.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GER</td>
      <td>Germany</td>
      <td>454.0</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code class="language-python">gold.join(bronze, lsuffix='_gold', rsuffix='_bronze')
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NOC_gold</th>
      <th>Country_gold</th>
      <th>Total_gold</th>
      <th>NOC_bronze</th>
      <th>Country_bronze</th>
      <th>Total_bronze</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>USA</td>
      <td>United States</td>
      <td>2088.0</td>
      <td>USA</td>
      <td>United States</td>
      <td>1052.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>URS</td>
      <td>Soviet Union</td>
      <td>838.0</td>
      <td>URS</td>
      <td>Soviet Union</td>
      <td>584.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>GBR</td>
      <td>United Kingdom</td>
      <td>498.0</td>
      <td>GBR</td>
      <td>United Kingdom</td>
      <td>505.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ITA</td>
      <td>Italy</td>
      <td>460.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GER</td>
      <td>Germany</td>
      <td>407.0</td>
      <td>GER</td>
      <td>Germany</td>
      <td>454.0</td>
    </tr>
  </tbody>
</table>
</div>
<h4 id="left--right-merging-on-multiple-columns">Left &amp; right merging on multiple columns</h4>
<p>In addition to the revenue and managers DataFrames from prior exercises, you have a DataFrame sales that summarizes units sold from specific branches (identified by city and state but not branch_id).</p>
<p>Once again, the managers DataFrame uses the label branch in place of city as in the other two DataFrames. Your task here is to employ left and right merges to preserve data and identify where data is missing.</p>
<p>By merging revenue and sales with a right merge, you can identify the missing revenue values. Here, you don&rsquo;t need to specify left_on or right_on because the columns to merge on have matching labels.</p>
<p>By merging sales and managers with a left merge, you can identify the missing manager. Here, the columns to merge on have conflicting labels, so you must specify left_on and right_on. In both cases, you&rsquo;re looking to figure out how to connect the fields in rows containing Springfield.</p>
<pre><code class="language-python">import pandas as pd

revenue = pd.read_csv('Sales/revenue.csv', delim_whitespace=True)
managers = pd.read_csv('Sales/managers.csv', delim_whitespace=True)
sales = pd.read_csv('Sales/sales.csv', delim_whitespace=True)
</code></pre>
<pre><code class="language-python">revenue.head()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>city</th>
      <th>branch_id</th>
      <th>state</th>
      <th>revenue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Austin</td>
      <td>10</td>
      <td>TX</td>
      <td>100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Denver</td>
      <td>20</td>
      <td>CO</td>
      <td>83</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Springfield</td>
      <td>30</td>
      <td>IL</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Mendocino</td>
      <td>47</td>
      <td>CA</td>
      <td>200</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code class="language-python">managers.head()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>branch</th>
      <th>branch_id</th>
      <th>state</th>
      <th>manager</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Austin</td>
      <td>10</td>
      <td>TX</td>
      <td>Charlers</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Denver</td>
      <td>20</td>
      <td>CO</td>
      <td>Joel</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mendocino</td>
      <td>47</td>
      <td>CA</td>
      <td>Brett</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Springfield</td>
      <td>31</td>
      <td>MO</td>
      <td>Sally</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code class="language-python">sales.head()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>city</th>
      <th>state</th>
      <th>units</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mendocino</td>
      <td>CA</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Denver</td>
      <td>CO</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Austin</td>
      <td>TX</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Springfield</td>
      <td>MO</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Springfield</td>
      <td>IL</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code class="language-python"># Merge revenue and sales: revenue_and_sales
revenue_and_sales = pd.merge(revenue,sales, how='right', on=['city','state'])

# Print revenue_and_sales
print(revenue_and_sales)

# Merge sales and managers: sales_and_managers
sales_and_managers = pd.merge(sales, managers, how='left', left_on=['city','state'], right_on=['branch','state'])

# Print sales_and_managers
print(sales_and_managers)
</code></pre>
<pre><code>          city  branch_id state  revenue  units
0       Austin       10.0    TX    100.0      2
1       Denver       20.0    CO     83.0      4
2  Springfield       30.0    IL      4.0      1
3    Mendocino       47.0    CA    200.0      1
4  Springfield        NaN    MO      NaN      5
          city state  units       branch  branch_id   manager
0    Mendocino    CA      1    Mendocino       47.0     Brett
1       Denver    CO      4       Denver       20.0      Joel
2       Austin    TX      2       Austin       10.0  Charlers
3  Springfield    MO      5  Springfield       31.0     Sally
4  Springfield    IL      1          NaN        NaN       NaN
</code></pre>
<h3 id="special-care-needed-with-innerouter-join">Special care needed with inner/outer join</h3>
<p>Notice how the default merge drops the Springfield rows, while the default outer merge includes them twice.</p>
<pre><code class="language-python"># Perform the first merge: merge_default
merge_default = pd.merge(sales_and_managers, revenue_and_sales)

# Print merge_default
print(merge_default)

# Perform the second merge: merge_outer
merge_outer = pd.merge(sales_and_managers, revenue_and_sales, how='outer')

# Print merge_outer
print(merge_outer)

# Perform the third merge: merge_outer_on
merge_outer_on = pd.merge(sales_and_managers, revenue_and_sales, how='outer', on=['city','state'])

# Print merge_outer_on
print(merge_outer_on)
</code></pre>
<pre><code>        city state  units     branch  branch_id   manager  revenue
0  Mendocino    CA      1  Mendocino       47.0     Brett    200.0
1     Denver    CO      4     Denver       20.0      Joel     83.0
2     Austin    TX      2     Austin       10.0  Charlers    100.0
          city state  units       branch  branch_id   manager  revenue
0    Mendocino    CA      1    Mendocino       47.0     Brett    200.0
1       Denver    CO      4       Denver       20.0      Joel     83.0
2       Austin    TX      2       Austin       10.0  Charlers    100.0
3  Springfield    MO      5  Springfield       31.0     Sally      NaN
4  Springfield    IL      1          NaN        NaN       NaN      NaN
5  Springfield    IL      1          NaN       30.0       NaN      4.0
6  Springfield    MO      5          NaN        NaN       NaN      NaN
          city state  units_x       branch  branch_id_x   manager  \
0    Mendocino    CA        1    Mendocino         47.0     Brett   
1       Denver    CO        4       Denver         20.0      Joel   
2       Austin    TX        2       Austin         10.0  Charlers   
3  Springfield    MO        5  Springfield         31.0     Sally   
4  Springfield    IL        1          NaN          NaN       NaN   

   branch_id_y  revenue  units_y  
0         47.0    200.0        1  
1         20.0     83.0        4  
2         10.0    100.0        2  
3          NaN      NaN        5  
4         30.0      4.0        1  
</code></pre>

</div>
  <aside>
      <div class="bug_reporting">
          <h4>Find an error?</h4>
          <p>All material is saved on GitHub. Please <a href='https://github.com/othrif/notes_othmanerifki/issues/new'>submit a suggested change</a> and include the note's URL in the issue.</p>
      </div>
      </aside>

    </div>
</article>




      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.4.8/mermaid.min.js" integrity="sha256-lyWCDMnMeZiXRi7Zl54sZGKYmgQs4izcT7+tKc+KUBk=" crossorigin="anonymous" title="mermaid"></script>
      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
      

    

    
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.37431be2d92d7fb0160054761ab79602.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  


</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
